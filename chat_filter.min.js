(function(){"use strict";function l(e,t){if(e.length===0)return t.length;if(t.length===0)return e.length;var n=[];for(var r=0;r<=t.length;r++){n[r]=[r]}for(var i=0;i<=e.length;i++){n[0][i]=i}for(var r=1;r<=t.length;r++){for(var i=1;i<=e.length;i++){if(t.charAt(r-1)==e.charAt(i-1)){n[r][i]=n[r-1][i-1]}else{n[r][i]=Math.min(n[r-1][i-1]+1,Math.min(n[r][i-1]+1,n[r-1][i]+1))}}}return n[t.length][e.length]}var e=["left","right","up","down","start","select","a","b","democracy","anarchy"];var t=["oligarchy","bureaucracy","monarchy","alt f4"];var n=3;var r=2;var i=2;var s;try{s=unsafeWindow}catch(o){s=window}var u=s.jQuery;var a=new RegExp("^(("+e.join("|")+")\\d?)+$","i");var f=new RegExp("^(("+t.join("|")+")\\d?)+$","i");var c=function(t){t=t.replace(/\s/g,"");if(t.match(a)){return true}var n=e.map(function(e){return l(e,t)}).reduce(function(e,t,n,r){return Math.min(e,t)});if(n<=i){return true}return false};var h=function(e){e=e.replace(/\s/g,"");if(e.length<n){return true}if(e.match(f)){return true}var s=0;for(var o=0;o<e.length;o++){if(e.charCodeAt(o)>127){s++;if(s>r){return true}}}var u=t.map(function(t){return l(t,e)}).reduce(function(e,t,n,r){return Math.min(e,t)});if(u<i){return true}return false};var p=function(){u("<style type='text/css' >"+".segmented_tabs li li a.SpamToggle {"+"width: 35px;"+"padding-left: 15px;"+"padding-top: 0;"+"height: 8px;"+"line-height: 115%;"+"}"+".segmented_tabs li li a.ChatToggle {"+"width: 35px;"+"padding-left: 15px;"+"padding-top: 0;"+"height: 8px;"+"line-height: 115%;"+"}"+"#chat_line_list li { display:none }"+"#chat_line_list li.fromjtv,"+"#chat_line_list.showSpam li.cSpam,"+"#chat_line_list.showSafe li.cSafe {"+"display:inherit;"+"}"+" </style>").appendTo("head");var e=u("ul.segmented_tabs li a").first();e.css("width",e.width()-71);u("<li><a class='SpamToggle'>Spam</a><a class='ChatToggle'>Talk</a></li>").insertAfter(e);u(".SpamToggle").click(function(){u(this).toggleClass("selected");u("#chat_line_list").toggleClass("showSpam")});u(".ChatToggle").click(function(){u(this).toggleClass("selected");u("#chat_line_list").toggleClass("showSafe")}).click()};var d=function(){var e=s.CurrentChat;e.line_buffer=800;u("#chat_line_list li").each(function(){var e=u(this);var t=e.find(".chat_line").text();var n;if(c(t)){n="cCmd"}else if(h(t)){n="cSpam"}else{n="cSafe"}e.addClass(n)});var t=e.insert_chat_line;e.insert_chat_line=function(e){t.call(this,e);var n=this.queue[this.queue.length-1];var r;if(c(e.message)){r="cCmd"}else if(h(e.message)){r="cSpam"}else{r="cSafe"}n.line=n.line.replace('class="','class="'+r+" ")}};u(function(){p();if(s.CurrentChat){d()}else{u(s).on("load",function(){d()})}})})()
