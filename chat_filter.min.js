(function(){"use strict";function f(e,t){if(e.length===0)return t.length;if(t.length===0)return e.length;var n=[];for(var r=0;r<=t.length;r++){n[r]=[r]}for(var i=0;i<=e.length;i++){n[0][i]=i}for(var r=1;r<=t.length;r++){for(var i=1;i<=e.length;i++){if(t.charAt(r-1)==e.charAt(i-1)){n[r][i]=n[r-1][i-1]}else{n[r][i]=Math.min(n[r-1][i-1]+1,Math.min(n[r][i-1]+1,n[r-1][i]+1))}}}return n[t.length][e.length]}function p(e){if(i.length!==0){i.unshift(e)}else{i[0]=e}if(i.length>=20){i.pop()}u("#command_panel").text(i.toString())}var e=["left","right","up","down","start","select","a","b","democracy","anarchy","oligarchy","bureaucracy","monarchy","alt f4"];var t=3;var n=2;var r=2;var i=[];var s;try{s=unsafeWindow}catch(o){s=window}var u=s.jQuery;var a=new RegExp("^(("+e.join("|")+")\\d?)+$","i");var l=function(i){i=i.replace(/\s/g,"");if(i.length<t){return true}if(i.match(a)){p(i);return true}var s=0;for(var o=0;o<i.length;o++){if(i.charCodeAt(o)>127){s++;if(s>n){return true}}}var u=e.map(function(e){return f(e,i)}).reduce(function(e,t,n,r){return Math.min(e,t)});if(u<=r){return true}return false};var c=function(){u("<style type='text/css' >"+".segmented_tabs li li a.CommandsToggle {"+"width: 50px;"+"padding-left: 0;"+"padding-top: 0;"+"height: 8px;"+"line-height: 115%;"+"}"+".segmented_tabs li li a.ChatToggle {"+"width: 35px;"+"padding-left: 15px;"+"padding-top: 0;"+"height: 8px;"+"line-height: 115%;"+"}"+"#chat_line_list li { display:none }"+"#chat_line_list li.fromjtv,"+"#chat_line_list.showSpam li.cSpam,"+"#chat_line_list.showSafe li.cSafe {"+"display:inherit;"+"}"+" </style>").appendTo("head");var e=u("ul.segmented_tabs li a").first();e.css("width",e.width()-71);u("<li><a class='CommandsToggle'>Commands</a><a class='ChatToggle'>Talk</a></li>").insertAfter(e);u(".CommandsToggle").click(function(){u(this).toggleClass("selected");u("#chat_line_list").toggleClass("showSpam")});u(".ChatToggle").click(function(){u(this).toggleClass("selected");u("#chat_line_list").toggleClass("showSafe")}).click();var t=document.createElement("div");t.setAttribute("id","command_panel");t.setAttribute("style","background: grey;display: block; overflow: hidden;");t.innerText=i;u(t).insertBefore("#player")};var h=function(){var e=s.CurrentChat;e.line_buffer=800;u("#chat_line_list li").each(function(){var e=u(this);var t=e.find(".chat_line").text();var n=l(t)?"cSpam":"cSafe";e.addClass(n)});var t=e.insert_chat_line;e.insert_chat_line=function(e){t.call(this,e);var n=this.queue[this.queue.length-1];var r=l(e.message)?"cSpam":"cSafe";n.line=n.line.replace('class="','class="'+r+" ")}};u(function(){c();if(s.CurrentChat){h()}else{u(s).on("load",function(){h()})}})})()